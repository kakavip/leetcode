#
# @lc app=leetcode id=1653 lang=python3
#
# [1653] Minimum Deletions to Make String Balanced
#


# @lc code=start
from typing import List


class Solution:
    def minimumDeletions(self, s: str) -> int:
        if "a" not in s or "b" not in s:
            return 0

        n = len(s)
        a_cum = [0] * n
        b_cum = [0] * n

        for i in range(n):
            b_cum[i] = b_cum[i - 1]
            if s[i] == "b":
                b_cum[i] += 1

            reverse_i = n - 1 - i
            a_cum[reverse_i] = 0 if reverse_i == n - 1 else a_cum[reverse_i + 1]
            if s[reverse_i] == "a":
                a_cum[reverse_i] += 1

        # print("A CUM", a_cum)
        # print("B CUM", b_cum)

        _min = float("inf")
        for i in range(n):
            _sum = b_cum[i] + a_cum[i]
            if _sum < _min:
                _min = _sum

        return _min - 1


# @lc code=end

if __name__ == "__main__":
    s = Solution()
    print(s.minimumDeletions("aababbab") == 2)
    print(s.minimumDeletions("bbaaaaabb") == 2)
    print(
        s.minimumDeletions(
            "bbbbbbaaabbbabbbaabbabababaabaabaaaaabbaabbaaababaababbaaaaababbbabababbabaabbababbabaabbbbbaaaabbababbbaabbbabaabaaabbaaaabbbabbaaabbbbbbbabaababababbbabbababbbaabbbabbbbbbbbbbabbaabaaabbaaababbabbababbbbaababaabbaaabaaabaaabbaaabbaaaabaabbabbbaaabbbbbaaababaabaabababbbabaaababbbbbaaabaabbaaabbaabaabbaabbbaaaabababababbbbabaaaaaaababbababbaaabaabbbbababbaabbaabbaaaabaaaaaaabbbbbbbbaabbabbbabaaabababbbbbaababbabaabbaabababbbbbaabababaabbbbbaaababbaabbbbbaabaaabaaaaababbbabaabbaaababbbbbbbabaaaabaaaaaabbbbaaabaaabbaaabbaaaaaabbaaabaaaabababbababbabbaabbbbbbabaaabbabbabaaabbbababbbbbbbaabbabaaabbabbbbaaabbabaaabbaaabbabbbabaabbaaaabbbbbaabbbbbaabbbaaaaabbaabbaaabbbabaabaaabababaabbababaababbaaaabbbaabbaabaaaabbababbbbbbbbabababbbaaaabbbbbbbbaabababbbabaaabbbbaaaaaaaabbbabbbbaaaabaabbbbaaaabbababbbbbbaabababaabaabbabaaabbbbabaaaabbabbbbabbababbabbaaababbbabbbbabbaaabaababaababaaabaaaabaaababbaaabaaaababaababbaaabaabaabbaabbbbaaaabbaabaaaaaabbabaaabbaababaaababbabbbbbbbaabbbbbbbbabbbbabbbabababaaaabbbbaaabbaaaabababaaabaaabbabbbabbaaabbbbaaaaabaaababaabbabbbaabaabbbbaaabaabaabababaaabaaababbaaababbbbabbaabaabbaabbaabbabaaaaabbbabbaabbbbbbabaaaaabaabbbabaabaaaaabbabbabaaaabbbabaaabbbbaababbbbbabaaababaabaabbabbabbababbbabaaaaabbbbaaaaaaaabaaababbaaaaaaabbbbbaaaabababaaabbaabbbbabbbbbaabbbaaaaaaabbbaabbbaaaabbaaabaaaabbbbbabbbbabaabbbaaabaabbbbbabbabaababbbaaaaaaaaabaaaabaaaabbabbbbabbbbbaaaabbaaaabbabababbbbabbaaaabbbbbbbababaaababaaababababbbbabaaaaabbaaaabbbaabaaaaabbaaabbbbaabbbbabaabaabbbbbaaabaabaabaaabbabbaabaabababbabbabbbaabaaaababababbabbbbbabaabaaaaabbbbaaabaabbbaaabbbbaabaaabababbbbabaaabbaabbaaabaabbaabaaaabbbaaababbbbaaabbabbaaaaabbbbbabaababbbaabaaaabbaaabbaabbbbababaaabbabbaabbbbaabaabbababaabababaabaaabbaabbbbbabbaababbabbbbbbaaabbabbabbbbbbaaabbaaababbbaaabbbbaababbbbbbbaabbaabbaaaaaabaabbababaaaabbbaaaaabaaaabbaabbbaaabbbbbbbaababbaaababbbaababbaabababaabbabababbaaabaaaaaaabbaaaaabbababaaabaaabaabbababbabbbabaabbbbbbaabbbaabaaaabbbbbababaaaaabaaaaaabbbbaaaababbbbaabababbbaababbabbbabbbabbbbaaaabbabababbbaabababbbabaaaabbaabbbbbbbaaabaabbbaabaabbbababbbbabbbbaabbbababaaababbabaabbbababbbbabbbaabaaaaaabbbaaaabbabbbbbbbaabbbaabaabaaaababbaaaabaaaabbbaaabbbabbbbabbababbbbabbabbaabaaabbaaaabbbabababbabababbbaaabbabaababbbbababbbabbbbaaaaabaabaabbbbbbbbabaabaabaaaabbaaaabababbaaabbaabbabbbbbbbabaaaababbaaabbabbabaabaabaaaaababbaabbaaaabbaaaababababbabaaaabbabbbbababbaaabaabbbaabaabaabaaabaaaabbababababaababbababbbbaaabbababbbababbabbabbaaababbbaabaabbabaababababaababaabaababbababaababbbabaaaaababbabbbbaabbabaabaabbaababbabbbaaababbbabbabaaaaaaabaaababaaaaaaabbbbabababaaaababbbbabaaaabbabbbabababbaaaabababbaaabbbababaabbaaaabbaabbbababaaaaabbbbbbababaaabbaabbbbbabbababbabbbbaababaabbaaabbababbbbbbaabaaabbbaabbbbbbbbabbaaabbbbaababbaababbbbaaabaaababbbaabaabaabbbaaabbaaaaabababbabbabbaababababbbbbbabbbaababaabaaabbaaaabbaaaaabbaabbbaabababaaabbbbbabbbbaabbaaaabbbbbbabbabbabbbaabbbbbbaababbaaabbbbbbaabaaaaaaabbaabababbabbbababbabbbaabaabaaabbaaabbabaaaababaabbabababbaababaabbaaaabbbbbaabbaabaaaaabaabbbbbbbbababbabaaaaababaaabbababaaabaaabaaabaabaaaaababbbbbbabaababaababaaabbbbaabbabbaababaaaabbbbbbaabaabbbabbbbbbabaabbabbaaaababbaaaaaababbbaaababbbbabbbabababbbbbaabbbbbbabaabaabaabaaabaaaabbbaabbabaaabaaaaabaabaabaaabbaaabbabbbbabbbbaaaaaabaaaaababababbbabbaaaaabababbabaabaaababbbbbababaaaaabaaabaabbbaabaababbbbaaabbabbaaabbbbabbbbbbabaabbaaabaaabaaaaabbbabbbabaaaaaaabbbbbaaabbbbbaaaababbbbbbbabaababbabbaabbbaaaababaaaabaabbbaababbbbbabbbaaababaababbaabbabbbaaabbbbbabbababbaababababbabbaaaaaabbbbbaabbbbbbbaaabbbbbaaabbbabbbbbbbbbbaabaabaaabbbaaaabbabbaaaaabbaaabaaaabaabbbaaaabbbbbbbabaabaaabaabababbabbaaabaababbabbbabaaabaaababbaaabbbabbbaababbbabbbbbabaaaabbaaababbbabbbbbaabaaabbbbaabbbbbbabbaaaaaaabaabbbbbbabbbaaaaaaabaaabaaabbabbaabbabbbaabbbabbbabbbaabbabaabbbaabbabbbabaaaabbaabbbbabbabbbabababbbbbbbabaabababaabbbabbbbabbbbbbaababbaabbbbaabaabbbbbbbbbaababaaabaaaabbbaabbbabbaaabababbababaabbaaaaaabbababbaaaaabaababaaaabaababaaaaabbaaabbbbaabbbaaababbababababbbbaaaabbbabbaaababbbbbababbaaaabababbbbababbbaaabaaabbbaaaaaaabaabbbabbabaababbaabababbbaaaaabbbbbaabaaaaaabbbbbaaaaaabbbaaababbabaaaaaabbbaaaaababaaaababababbabbaabbabbbaabbabbbaabbaaabbabaaaabaabbabbbabaaabbaabbbabbbbabaabbbaabbaaaaabbbbbabbbaaabaaaabbabbbabbaabaaaababbaabbaaababbbaaabbbbabbbbabbbbbabbaabbabbabbbaaabaabaaabbaaaaabbbaaabbbbabababbaabaabbabbbaaaabbaabbababbbabbabaaaaabbbbaaabaababaabbbbbbbababbbbaabbaabaabbaaaaabbabbbababbabaabbaabaaaababbbbaabbbabaaaabaaaaaaaaabaaabbabbabbbabbabababbbabaaaabaabaaaabbaaabbbabbbbbbaaaaabbaaabbbabbbbbaaaabbaabababbaabbaaaaaababbbabbbbabababbbbabbababbaaabaaabbbbbaaaabbbaabaaabaabbbbbaabbbabaaabbaaabaaabbbbbbbbbbbabaaabbabbabbbbbbbaabababaabbabaabbbbaaabbbabaaaabaaaababbbaababbaabbaabbbabbbabbababaaababbababaaabbaaabaaabaabbbbbaabaababaaaaabaaabbabbabaabbbabbaabbababbabaaabaabaaabaaaabbbabbbbbabbaaaaaababaaaaaaabbaaabbaababaaaababababbbbababbbabaaaaaababbaabababbbabaaaaababbaaabbaabaababaaabbabbbbaaaababbabaababbabaababbabbaabbbbabbabbbbbaabbaabaaababbaabbbaaaaabbbbaabaaaaaababbbbabaaaabbabbaaaabbaaababbabaaaaaabbbabbabaabaaabaaaabbbbaabbbbabbaababababbaaabbbbaaabbbbbbabbbbabbaababbbaaabbbabaaaabaaabbabaabaaaaaaabbaabaabbbaaaababbbbabaabbabbaabaabbabaaabbabbbbbabbabbbbbbabababaabbabbbbaaabababaabbbbbbaaabaabbaabbaabaababaabbaaaabbaaaaaaaaaabbbabaaaaabbaabbababbaabbababaaabaaababaaabbaaabaabaaababbabbaaaaababaabbbbaaabbabbabaaaaaaabaabbbaaaababababaaabbbabaaaaaabaaabaaaaabaababaaabbababaababbababaaaababababbbabaaabaabaaaaabbabbbababbbbaabbbbabbabaaaaaaaabbbabaaabbbbabbababbbbabbbabbaabbbaabaabbaaabbaaaabbabaabaaaaaaaabbbbbabbbbaaaaabbbbbbbaabbbbbaaabbabaabbabbabbbbaaabaaaababbabaabaaaabaabbaaabbabbabbbaabaaabbaaababbabbaabbbbbabbabbbaaaabbababbbbabbabbbabbabaababbabababaaaabbbbababbaabaaababbbbbbbaaaaaaabababbaabbaabbbabbbbbabbaaaaaabbbaabbbaaabbbbabaababbaababaabbbaabaaaabababbbbbababbaaabbaaaabbabbbaaabbbabbaabaaababbbaabbbbbabaabababbbbaabababbaabbaababbbaaaababbbabaabbbaabbaaaaabbbbaababbbababbbbaaaaaaaabaabaabbbabbaabaaaabaaaaabbbbbaabaababbbbaabbbabbabaaababbabbaabababbbaaaabbbaaaaaaabaaaaababbabbbaababaaabbbbbbbaabaabbbabaaabababaaababbaaaabaaabaabbaabbbbaaabbaaabbaaaababbaaaababbbbabaaaabaaaababbabbaaababaaabaababbbabaaabaabbababababaababbaaababababbbaabbbbaabbabaababbaababbbbbbaabbbabaaaababababaabbbbababbaabaabbabbbaabaabbabbaababbaaaabbbabbabbbbbbbaaabbaaaabaaaabbabaababaaaababbaabbbbaabbaabaabaaaaaaaaababbaababbbbbbaaaababbaababbabaabbbbbbabababababbabbaabbaaabaababbaabbbaabbabbabbbababaaababbabaabaabbabbabbabbabaabaababaaaaaaaaaabbbbbbbbabbbbbaabbabbabbbababbbbaaaabaaaabbabbbababababaababbabaaaaaaaaaaaabbbbbbbaaaabbbabbaaaabbaaabbabbaaabaabbabbbbaaaaabaaaabaabbbbbaabbbbbbaabaaaabbbaabbbabaaabaabbaaaabbaabbaaaabbbababbbbaaabaaaabaaabbaababbbabbbabbabaaaaaababaaaaabbbbaaaabaaabbaabbaabababaaabbbbbbaaababbabbbababaaabbbabbbbbaababbbbbbabaabaaabababaabaabbbbabbbababaabaabaaaaabaabbababbaaaaabbaaaabbbababbbaababbabbaaabaabbbabbaaabbbbbaaaababaababbababbaababbbbbabababbabbbbaababbbaaabbbabbaababbbabbabbbbbaababbbbabaaabbbabababbbbbbbbbaaabbbbaabbabbbbbbbabbbbababbaabbbbbbbabaabbbabbaaabaabaaabbbbaaabbbabbbbabaaaaabbbabbbbbabaabbabbbaabaabaaabbaaaabaabbbbbbbabaaabaabaabbbbbabbbaaababaaabbabbbaababbaaaabbabaababbaaaaababaaaabbabaabaabaabbaaabaaabbababaabbbabbabaababaabbaaabbaabbababbbbabbabbaaaaabaabaabbaaaabbbbbaabaaabbaaababbbbbabaaabbaaaababbbbaaaaaaaaabbabaaaabbbbbbbaaabaabbaabbaaabbaabaabaaabbabaababababbbbbbbaaabbbbaababbabbabbbaabaababaaaabbabbaaaabaaabaaabbabbaababbbbabbabababbbbaabababbabaabaaaabbbbbaabbbaaabbbabbaaabbabababbbabbaaaabbaabababbbbbbbbbbbbbaabaabbbabababbaabbabaaabbbbbaabbbbaabaabbaaaabbabaaaababaabaabaaaaaababbbabbbbaabbaababbbababbaaaabbaaababaaaaaaabaaaabaaabbabbaaababaaaaaabbabbbbbbaabaabaabbababbbabbaaabaabbaabababbbaabaabbbabbbabaaaaaaaaaabbbaabbaabaaaabaaaaababbbbbbbabababbabbaabaabaaabbbbaaaabaaababbabaaabaabaaaaabaababaababbbaaabbbbaabbbabbbbaaaabaabbababaabaaabbabbbaababbaaaaaabaaaaaaabbbababbaabaaabbbabababbaababbabbaabaabbbbaabbbbaabbbbaabababbbbabaababaabbabaaababbaaaabaabaaaaabaabababaababaaabbaaabbaaaababbbaaababbbabaabababbaabaaabbbbabbabbbaabaabbbbbbabaabbbaabaaabbbbbbabaaabaaabaaabaabaabaabbbbbabaaabbaaababbbbbabaabbbaaaaaabaabaaababbbaaaabababababbababaaabbbbbbbababbaabbbbaaaaaaabbabbaaaabaaabbbbbbaabbbabbbaabbbbaabaaaaaabababbabbbbaaabbabaababbbbabbbaaaabbabaabaabbaaaabbabababababbabbaabababbababababbabaaababbbabbaaababbaababbaaababbbbbabaaaabbabbaaabbbaabaabaaabbaaabbabbbbabbabbabbabbaaabbaabbbbbaaaabaabaaabbbbbbbbababbbbbaabaabaabaababbbaaabbabbbbaabbbabbaabaaaaaabbbbabaabaabaaababbbbaabbaaabbbbbaaaaaaabbaabbbabbbbbbaaababbbabbbaabababbabbabbabaabbabaabbaaabbbbbababaabbaaaaaaabbbabbbabbabbbbabaabbaabababaabbbababbabbaaaaabaabbbbbabaaaabaabaaaaaaaaaabbaabaabaabbaababaaaabbaaabaaaaabbbbbabaaaaaabbbaabbaaaababbaabaaabababbabbabbbabaabbaaaabababbababbbaaaaaaabbbbaabababbbbbbaabbbabbabbbbababbbbaabaabbbbaabaabaaabbaaaabbabbbabbbbabbbbbbaaababaabababbababbababbabbbbabbbbaaaaaaaabbbabbbbabaabaabbaababaaaabaabaabbababbabbbaabbaaabaaababbababaaabbbbbabbbbbbbbbaaaaababababbbabbaaabbabbbbaabbbbbbabbbbabbbbbbaabaaababaaabaaaabbbbbbbaaaabbbaabbaaabaaabaababbbbbaaabbaaaaaaabbabbbabaaabbbaaaaabababbaaabbabbbbbabababaaaaaabbaababbbaaaaaaabaaaaababaaaaabaaababbbbabbbbaabbaabaabaaaabaabbbaaaaaaaaaaaabbababaaaabaabaababababaaaaabaabaabaabababaaaaababaaaaababbbbbabaabbaaabbaaabaaabbbaababbbaababaababbbbaabbbbaaababbbbbbbbabbaabaabbbbbaaabaabbaaaabababbaabbbbaabbabaabbbabbbbabaaabbaabbaaabbabaaabbabbabbbbaabaabbabbbabbbbbbaabaababbbabaababababbaabababaababbababaaaaaaaabbabbbbabbabaabababaababbbaaaababbaaababaabababbbbbabbaabaaaaaaabbabaababbaabbbabababbabbbabaabbbbbbbaababaaabbbabaabbbbbbabbbbbbbbabbabababaabbbbabbabaabababbaaaabaaabbaaabbbaabaababbbaaaaaaaababbaababaaaabaabbaabbabaabbbabbbbaaaabbbbbaabababaabbbbaaababbbbabbbbbaababbababaaabaaababbbbbbabbbbabbabbbaabbabbaabbbabbabaaababababbabbbabaaabaabaababaaaabbbbaabaabbabaaaabbbaabababbaaabbababaaabaabababbbabababaaaa"
        )
    )
