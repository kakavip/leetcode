#
# @lc app=leetcode id=1395 lang=python3
#
# [1395] Count Number of Teams
#
from typing import Dict, List


# @lc code=start


def insert_val_to_list(arr: List[int], val: int) -> int:
    if not arr:
        return 0

    mark_idx = 0
    start, end = 0, len(arr)
    while start < end:
        mid: int = (start + end) // 2
        if arr[mid] > val:
            mark_idx = mid
            end = mid
        else:
            start = mid + 1
            mark_idx = mid + 1

    return mark_idx


class Solution:
    def numTeams(self, rating: List[int]) -> int:
        counter: int = 0
        n = len(rating)

        previous_counter: Dict[int, List[int]] = {}
        previous_arr: List[int] = []

        next_counter: Dict[int, List[int]] = {}
        next_arr: List[int] = []

        for i in range(n):
            mark_idx = insert_val_to_list(previous_arr, rating[i])
            previous_arr = (
                previous_arr[:mark_idx] + [rating[i]] + previous_arr[mark_idx:]
            )

            cn = i
            previous_counter[rating[i]] = [mark_idx, cn - mark_idx]

            reverse_i = n - 1 - i
            reverse_mark_idx = insert_val_to_list(next_arr, rating[reverse_i])
            next_arr = (
                next_arr[:reverse_mark_idx]
                + [rating[reverse_i]]
                + next_arr[reverse_mark_idx:]
            )

            reverse_cn = n - 1 - reverse_i

            next_counter[rating[reverse_i]] = [
                reverse_mark_idx,
                reverse_cn - reverse_mark_idx,
            ]

        # print(previous_counter)
        # print(next_counter)

        for i in range(n):
            counter += previous_counter[rating[i]][0] * next_counter[rating[i]][1]
            counter += previous_counter[rating[i]][1] * next_counter[rating[i]][0]

        # print(counter)

        return counter


# @lc code=end

if __name__ == "__main__":
    # arr = [2]
    # val = 5
    # print(insert_val_to_list(arr, val))

    s = Solution()
    print(s.numTeams([2, 5, 3, 4, 1]) == 3)
    print(
        s.numTeams(
            [
                971,
                1469,
                456,
                1198,
                2106,
                2370,
                2573,
                2294,
                2032,
                304,
                507,
                209,
                90,
                432,
                2321,
                1719,
                91,
                1862,
                2859,
                1237,
                1190,
                439,
                900,
                759,
                593,
                2387,
                1381,
                731,
                893,
                2525,
                2472,
                2964,
                2811,
                1245,
                194,
                1441,
                761,
                1776,
                2752,
                409,
                706,
                1308,
                2219,
                1417,
                2274,
                2259,
                1046,
                2379,
                519,
                1419,
                1639,
                2906,
                2293,
                1727,
                2839,
                1006,
                2419,
                1598,
                13,
                1450,
                822,
                876,
                2432,
                384,
                245,
                1096,
                2426,
                2667,
                1572,
                1464,
                652,
                2756,
                1452,
                2972,
                1053,
                2703,
                2941,
                1702,
                2937,
                2378,
                1379,
                313,
                1332,
                697,
                799,
                157,
                2698,
                2401,
                2915,
                2084,
                289,
                1774,
                2049,
                2696,
                2620,
                2627,
                1684,
                2269,
                2389,
                243,
                569,
                2341,
                1604,
                1011,
                2651,
                358,
                2311,
                1522,
                2301,
                521,
                370,
                1736,
                985,
                2356,
                1094,
                1544,
                2642,
                1809,
                191,
                2154,
                1625,
                473,
                1388,
                1547,
                2701,
                79,
                1067,
                1554,
                906,
                1241,
                2986,
                817,
                1883,
                2334,
                2528,
                1599,
                689,
                216,
                596,
                2074,
                328,
                2418,
                1264,
                2002,
                914,
                1127,
                584,
                2653,
                2011,
                130,
                2814,
                941,
                2997,
                1234,
                2671,
                1477,
                1505,
                2737,
                1027,
                2450,
                1403,
                2471,
                2917,
                2788,
                2925,
                1295,
                1322,
                1263,
                827,
                598,
                2554,
                2203,
                1075,
                1514,
                512,
                2240,
                1768,
                867,
                2765,
                1344,
                726,
                1022,
                2216,
                925,
                2878,
                1593,
                632,
                764,
                1602,
                1795,
                2652,
                2618,
                2226,
                1947,
                842,
                2098,
                1125,
                1921,
                1938,
                1369,
                600,
                2253,
                1819,
                1113,
                1785,
                2430,
                2382,
                533,
                1755,
                2628,
                2327,
                63,
                1252,
                974,
                242,
                2109,
                2164,
                2746,
                2773,
                1764,
                86,
                2024,
                1850,
                1086,
                45,
                2781,
                538,
                215,
                1728,
                926,
                134,
                2383,
                1826,
                33,
                937,
                2638,
                1048,
                2180,
                1098,
                331,
                2408,
                1690,
                2143,
                230,
                140,
                1526,
                4,
                1610,
                2673,
                2485,
                613,
                100,
                1149,
                143,
                1082,
                1498,
                1939,
                1423,
                1014,
                2107,
                2805,
                1605,
                1914,
                2542,
                73,
                1396,
                1760,
                1038,
                394,
                2134,
                68,
                962,
                879,
                975,
                2835,
                49,
                1839,
                2126,
                1223,
                2268,
                745,
                2402,
                588,
                2602,
                2062,
                986,
                111,
                1100,
                918,
                1932,
                52,
                2039,
                441,
                983,
                2465,
                2165,
                203,
                69,
                170,
                862,
                2547,
                2020,
                2810,
                2875,
                539,
                2108,
                2606,
                874,
                1062,
                2719,
                2881,
                913,
                391,
                1870,
                1097,
                38,
                2300,
                883,
                595,
                2531,
                2411,
                116,
                2718,
                1124,
                2365,
                2132,
                2535,
                1957,
                592,
                845,
                2255,
                2513,
                101,
                440,
                929,
                2094,
                808,
                967,
                2267,
                1009,
                749,
                2923,
                207,
                2163,
                1881,
                2324,
                1860,
                501,
                1233,
                1034,
                1737,
                2739,
                83,
                2088,
                1641,
                896,
                2867,
                2688,
                2598,
                2089,
                2210,
                5,
                1898,
                2198,
                1658,
                1944,
                1035,
                1899,
                1968,
                421,
                2784,
                2879,
                2509,
                520,
                257,
                2832,
                1405,
                405,
                1973,
                2990,
                1220,
                2095,
                498,
                2562,
                1158,
                1729,
                2027,
                142,
                2976,
                1935,
                826,
                976,
                2353,
                920,
                1408,
                110,
                348,
                2249,
                2207,
                36,
                634,
                616,
                1611,
                2927,
                794,
                15,
                884,
                2869,
                2516,
                1988,
                2008,
                2315,
                2809,
                2482,
                2445,
                436,
                1734,
                2004,
                2932,
                2443,
                622,
                2596,
                1564,
                2016,
                1270,
                1169,
                2330,
                786,
                44,
                93,
                1078,
                2174,
                2347,
                437,
                675,
                1359,
                1841,
                2229,
                1820,
                1801,
                2922,
                122,
                2885,
                1953,
                1906,
                296,
                790,
                1640,
                1229,
                2514,
                2486,
                2787,
                1800,
                1491,
                1662,
                812,
                1506,
                2769,
                1515,
                2151,
                522,
                836,
                1954,
                1431,
                2110,
                1301,
                2649,
                2650,
                599,
                2188,
                34,
                2152,
                1104,
                1562,
                543,
                2112,
                1834,
                2828,
                2530,
                1586,
                2935,
                2632,
                425,
                615,
                714,
                2843,
                2494,
                478,
                1558,
                1454,
                987,
                128,
                1003,
                1202,
                728,
                606,
                1695,
                2712,
                197,
                2604,
                899,
                21,
                677,
                2044,
                2555,
                1153,
                1614,
                1956,
                2023,
                1747,
                2220,
                2871,
                1699,
                1116,
                732,
                2586,
                1815,
                1261,
                1199,
                1965,
                1010,
                614,
                847,
                2054,
                2214,
                2097,
                508,
                2332,
                1319,
                1706,
                2366,
                284,
                2745,
                805,
                1983,
                1349,
                2102,
                1682,
                922,
                2172,
                1608,
                200,
                1780,
                2367,
                376,
                431,
                246,
                1201,
                2817,
                1024,
                544,
                1142,
                1781,
                1761,
                2439,
                2893,
                916,
                938,
                1555,
                881,
                2813,
                27,
                387,
                1531,
                2900,
                2750,
                1291,
                292,
                1909,
                2553,
                2852,
                994,
                2536,
                1770,
                2500,
                495,
                912,
                2521,
                2996,
                1120,
                744,
                676,
                1750,
                14,
                1248,
                2135,
                1069,
                2842,
                725,
                1943,
                2314,
                2273,
                3,
                1675,
                633,
                2863,
                2767,
                1099,
                1686,
                1384,
                1813,
                2708,
                690,
                2706,
                1958,
                1923,
                1784,
                796,
                1288,
                297,
                888,
                1652,
                1121,
                2149,
                835,
                2335,
                238,
                2130,
                1,
                321,
                1950,
                901,
                1171,
                235,
                1920,
                2848,
                828,
                1769,
                2663,
                1556,
                1131,
                792,
                642,
                1148,
                318,
                1601,
                2391,
                2740,
                2988,
                2440,
                2476,
                2898,
                2262,
                1738,
                2689,
                2251,
                2780,
                1560,
                475,
                640,
                117,
                1446,
                1206,
                2529,
                2857,
                1146,
                2624,
                338,
                1257,
                2831,
                1044,
                1475,
                2889,
                2404,
                301,
                605,
                1016,
                2410,
                1174,
                2914,
                1329,
                1847,
                506,
                1970,
                2899,
                2506,
                352,
                2905,
                175,
                755,
                486,
                2230,
                2617,
                2354,
                1794,
                199,
                1368,
                2171,
                2009,
            ]
        )
        == 18162098
    )
    print(s.numTeams([2, 1, 3]) == 0)
    print(s.numTeams([1, 2, 3, 4]) == 4)
